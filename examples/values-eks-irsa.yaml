# Example configuration for AWS EKS with IRSA (IAM Roles for Service Accounts)
# This is the recommended production configuration

s3:
  bucket: "production-helm-charts"
  region: "us-west-2"
  key: "index.yaml"

# Use IAM role attached to service account
auth:
  useIAMRole: true

# Service account with IRSA annotation
serviceAccount:
  create: true
  # Specify the IAM role ARN for IRSA
  roleArn: arn:aws:iam::123456789012:role/helm-s3-exporter-role
  name: helm-s3-exporter

# Scanning configuration
scan:
  interval: "5m"
  timeout: "30s"

# Enable ServiceMonitor for Prometheus Operator
serviceMonitor:
  enabled: true
  interval: 30s
  scrapeTimeout: 10s
  additionalLabels:
    prometheus: kube-prometheus

# Enable HTML dashboard
html:
  enabled: true
  path: "/charts"

# Production resource limits
resources:
  limits:
    cpu: 200m
    memory: 256Mi
  requests:
    cpu: 100m
    memory: 128Mi

# Security settings
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 65532
  fsGroup: 65532

securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  runAsUser: 65532

# Node affinity for specific node pools (optional)
# nodeSelector:
#   workload: monitoring

# Tolerations (optional)
# tolerations:
# - key: "monitoring"
#   operator: "Equal"
#   value: "true"
#   effect: "NoSchedule"

